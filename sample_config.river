logging {
  level  = "debug"
  format = "logfmt"
}

// Discover where to collect Grafana resources from.
discovery.file "targets_from_file" {
  files = ["/home/kevin/sandbox/work/agent/discovery_targets.json"]
}

// Collect dashboards.
grafana.scrape "resources_scrape" {
  targets    = discovery.file.targets_from_file.targets
  forward_to = [
    grafana.echo.resources_stdout.receiver,
    grafana.write.resources_write.receiver,
  ]

  scrape_interval = "10s"
  scrape_timeout  = "2s"
  resources_path = "/grafana"
}

grafana.echo "resources_stdout" {

}


grafana.write "resources_write" {
  host  = "localhost:3000"
  token = env("GRAFANA_SA_TOKEN")
}
